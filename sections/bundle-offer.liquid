{{ 'component-product.css' | asset_url | stylesheet_tag }}
{{ 'component-quantity-selector.css' | asset_url | stylesheet_tag }}
{# Uncomment the line below if you have component-price.css and want to include it #}
{# {{ 'component-price.css' | asset_url | stylesheet_tag }} #}

<section class="product-section" id="main-product-{{ section.id }}" data-section="{{ section.id }}">
  <div class="product-container">
    <div class="product-gallery">
      <div class="product-gallery__main-viewer">
        {%- for media in product.media -%}
          <div class="product-gallery__main-item" id="media-{{ media.id }}">
            {%- render 'product-media', media: media -%}
          </div>
        {%- endfor -%}
      </div>
      {%- if product.media.size > 1 -%}
        <div class="product-gallery__thumbnails">
          {%- for media in product.media -%}
            <a href="#media-{{ media.id }}" class="product-gallery__thumbnail-item" aria-label="{{ media.alt | escape }}">
              <img
                src="{{ media.preview_image | image_url: width: 200, height: 200 }}"
                alt="{{ media.alt | escape }}"
                width="100"
                height="100"
                loading="lazy"
              >
            </a>
          {%- endfor -%}
        </div>
      {%- endif -%}
    </div>

    <div class="product-info">
      {%- if section.settings.show_breadcrumbs -%}
        <nav aria-label="breadcrumb" class="product-info__breadcrumbs">
          <ol class="product-info__breadcrumbs-list">
            <li class="product-info__breadcrumbs-item">
              <a href="{{ routes.all_products_collection_url }}" class="product-info__breadcrumbs-link">{{ 'general.breadcrumbs.shop_all' | t }}</a>
            </li>
            {%- if product.collections.first -%}
              <li class="product-info__breadcrumbs-item">
                <a href="{{ product.collections.first.url }}" class="product-info__breadcrumbs-link">{{ product.collections.first.title }}</a>
              </li>
            {%- endif -%}
            <li class="product-info__breadcrumbs-item product-info__breadcrumbs-item--current" aria-current="page">
              <span class="product-info__breadcrumbs-text">{{ product.title }}</span>
            </li>
          </ol>
        </nav>
      {%- endif -%}
      
      <product-form class="product-form">
        <div class="product-form__inner">
          {%- for block in section.blocks -%}
            {%- case block.type -%}
              {%- when '@app' -%}
                {%- render block -%}
              {%- when 'title' -%}
                <h1 class="product-info__title" {{ block.shopify_attributes }}>
                  {{ product.title | escape }}
                </h1>
              {%- when 'price' -%}
                <div class="product-price" {{ block.shopify_attributes }}>
                  {%- render 'price', product: product, use_variant: true -%}
                </div>
              {%- when 'rating' -%}
                <div class="product-rating" {{ block.shopify_attributes }}>
                  {%- if block.settings.rating_code != blank -%}
                    {{ block.settings.rating_code }}
                  {%- else -%}
                    <div style="--rating: {{ block.settings.rating_value | default: 4 }};" class="rating-placeholder" role="img" aria-label="{{ 'accessibility.rating_label' | t: rating: block.settings.rating_value | default: 4, max_rating: 5 }}"></div>
                    <span class="rating-reviews-text">({{ block.settings.review_count | default: 0 }} {{ 'general.reviews' | t }})</span>
                  {%- endif -%}
                </div>
              {%- when 'variant_picker' -%}
                {%- unless product.has_only_default_variant -%}
                  <variant-selects id="variant-selects-{{ section.id }}" data-section="{{ section.id }}" data-url="{{ product.url }}" {{ block.shopify_attributes }}>
                    {%- for option in product.options_with_values -%}
                      <div class="product-form__option">
                        <label for="option-{{ section.id }}-{{ forloop.index0 }}">{{ option.name }}</label>
                        <select id="option-{{ section.id }}-{{ forloop.index0 }}" name="options[{{ option.name | escape }}]">
                          {%- for value in option.values -%}
                            <option value="{{ value | escape }}" {% if option.selected_value == value %}selected="selected"{% endif %}>
                              {{ value }}
                            </option>
                          {%- endfor -%}
                        </select>
                      </div>
                    {%- endfor -%}
                    <script type="application/json">
                      {{ product.variants | json }}
                    </script>
                  </variant-selects>
                {%- endunless -%}
              {%- when 'quantity_selector' -%}
                <div class="product-form__quantity" {{ block.shopify_attributes }}>
                  <label for="quantity-{{ section.id }}">{{ 'products.product.quantity' | t }}</label>
                  <quantity-selector class="quantity-selector">
                    <button class="quantity-selector__button" name="minus" type="button" aria-label="{{ 'accessibility.quantity_selector.decrease' | t }}">-</button>
                    <input class="quantity-selector__input"
                      type="number"
                      name="quantity"
                      id="quantity-{{ section.id }}"
                      value="1"
                      min="1"
                      aria-label="{{ 'accessibility.product_quantity' | t }}"
                    >
                    <button class="quantity-selector__button" name="plus" type="button" aria-label="{{ 'accessibility.quantity_selector.increase' | t }}">+</button>
                  </quantity-selector>
                </div>
              {%- when 'buy_buttons' -%}
                <div class="product-form__buttons" {{ block.shopify_attributes }}>
                  <button type="submit" name="add" class="button button--primary" {% if product.selected_or_first_available_variant.available == false %}disabled{% endif %}>
                    <span>
                      {%- if product.selected_or_first_available_variant.available -%}
                        {{ 'products.product.add_to_cart' | t }}
                      {%- else -%}
                        {{ 'products.product.sold_out' | t }}
                      {%- endif -%}
                    </span>
                  </button>
                  {%- if block.settings.show_dynamic_checkout -%}
                    {{ form | payment_button }}
                  {%- endif -%}
                </div>
              {%- when 'description' -%}
                <div class="product-description" {{ block.shopify_attributes }}>
                  {{ product.description }}
                </div>
              {%- when 'collapsible_tab' -%}
                <details class="collapsible-tab" {{ block.shopify_attributes }}>
                  <summary class="collapsible-tab__title">
                    {{ block.settings.heading | default: 'Información' }}
                  </summary>
                  <div class="collapsible-tab__content">
                    {{ block.settings.content }}
                  </div>
                </details>
            {%- endcase -%}
          {%- endfor -%}
        </div>
        <div class="product-form__hidden-inputs">
          <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
        </div>
      </product-form>

      {# === COMIENZO DEL CÓDIGO DEL BUNDLE === #}
      {# Este es el nuevo contenedor para tu módulo de bundle #}
      <div class="bundle-module">
        <h2>Bundle Especial: 10% OFF</h2>
        {%- liquid
          assign bundle_product_url = section.settings.bundle_product_url
          assign bundle_product = bundle_product_url.object
        -%}
        {%- if bundle_product != blank -%}
          {% assign bundle_variant = bundle_product.selected_or_first_available_variant %}
          <div class="bundle-card">
            <div class="bundle-card__image">
              <img src="{{ bundle_product.featured_image | image_url: width: 300 }}" alt="{{ bundle_product.title | escape }}" loading="lazy">
            </div>
            <div class="bundle-card__info">
              <h3>{{ bundle_product.title }}</h3>
              <p class="bundle-card__price">
                {{ bundle_variant.price | money }}
              </p>
              
              {# Selector de variantes para el producto del bundle #}
              {%- unless bundle_product.has_only_default_variant -%}
                <div class="bundle-card__variant-picker">
                  <label for="bundle-variant-{{ section.id }}">{{ 'products.product.variant_options' | t }}</label>
                  <select id="bundle-variant-{{ section.id }}" name="bundle_variant_id" class="bundle-variant-selector">
                    {%- for variant in bundle_product.variants -%}
                      <option value="{{ variant.id }}"
                              {% if variant.available == false %}disabled{% endif %}
                              {% if variant.id == bundle_variant.id %}selected{% endif %}
                      >
                        {{ variant.title }} - {{ variant.price | money }}
                      </option>
                    {%- endfor -%}
                  </select>
                </div>
              {%- endunless -%}

              <button type="button" class="button button--secondary add-bundle-to-cart"
                      data-main-product-id="{{ product.selected_or_first_available_variant.id }}"
                      data-bundle-product-id="{{ bundle_variant.id }}"
                      data-bundle-product-handle="{{ bundle_product.handle }}"
                      {% if product.selected_or_first_available_variant.available == false or bundle_variant.available == false %}disabled{% endif %}>
                Añadir Bundle al Carrito (10% OFF)
              </button>
            </div>
          </div>
        {%- else -%}
          <p>Por favor, selecciona un "Producto del Bundle" en la configuración de la sección.</p>
        {%- endif -%}
      </div>
      {# === FIN DEL CÓDIGO DEL BUNDLE === #}


      {%- if section.settings.shipping_promo_text != blank -%}
        <p class="product-info__promo-text">{{ section.settings.shipping_promo_text }}</p>
      {%- endif -%}
    </div>
  </div>
</section>

<style>
  /* ESTILOS ESENCIALES PARA LA SECCIÓN DE PRODUCTO */
  .product-section {
    padding: 2rem 5%;
    max-width: 1400px; /* Added max-width for better layout on large screens */
    margin: 0 auto; /* Center the section */
  }
  .product-container {
    display: grid;
    grid-template-columns: 1fr;
    gap: 2rem;
  }
  @media (min-width: 768px) {
    .product-container {
      grid-template-columns: 1.25fr 1fr;
      gap: 3rem;
    }
  }

  /* Galería de Imágenes */
  .product-gallery__main-viewer {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth; /* Added for smoother scrolling */
  }
  .product-gallery__main-item {
    flex: 0 0 100%;
    scroll-snap-align: center;
    aspect-ratio: 1 / 1;
  }
  .product-gallery__main-item img,
  .product-gallery__main-item .product-media__video {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  .product-gallery__thumbnails {
    display: flex;
    gap: 0.75rem;
    margin-top: 1rem;
    overflow-x: auto;
    justify-content: center; /* Center thumbnails */
    padding-bottom: 0.5rem; /* Add some padding for scrollbar */
  }
  .product-gallery__thumbnail-item {
    flex-shrink: 0;
    width: 80px;
    height: 80px;
    border: 1px solid #ddd;
    cursor: pointer;
    opacity: 0.7;
    transition: opacity 0.2s, border-color 0.2s; /* Added border-color transition */
  }
  .product-gallery__thumbnail-item:hover,
  .product-gallery__thumbnail-item:focus {
    opacity: 1;
    border-color: #333; /* Highlight on hover/focus */
  }
  .product-gallery__thumbnail-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  /* Info de producto */
  .product-info {
    display: flex;
    flex-direction: column;
  }
  .product-info__breadcrumbs {
    font-size: 0.875rem;
    color: #666;
    margin-bottom: 1rem;
  }
  .product-info__breadcrumbs-list { /* Added class for list */
    display: flex;
    flex-wrap: wrap;
    list-style: none;
    padding: 0;
    margin: 0;
    gap: 0.5rem;
  }
  .product-info__breadcrumbs-item:not(:last-child)::after {
    content: '>';
    margin-left: 0.5rem;
    opacity: 0.5;
  }
  .product-info__breadcrumbs-link,
  .product-info__breadcrumbs-text { /* Consistent styling for links and text */
    text-decoration: none;
    color: inherit;
  }
  .product-info__breadcrumbs-link:hover {
    text-decoration: underline;
  }
  .product-info__title {
    font-size: 2.5rem;
    font-weight: bold;
    margin: 0 0 1rem;
    line-height: 1.2; /* Improved readability */
  }
  .product-price { /* This styling should ideally be in component-price.css */
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 1rem;
  }
  .product-rating {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
  }
  /* Star rating placeholder */
  .rating-placeholder {
    --rating-fill: gold; /* Color of the stars */
    --rating-empty: lightgray; /* Color of empty stars */
    display: inline-block;
    position: relative;
    width: 5em; /* 5 stars * 1em per star */
    height: 1em;
    font-size: 1rem; /* Base font size for stars */
  }
  .rating-placeholder::before {
    content: '★★★★★';
    letter-spacing: 1px;
    background: linear-gradient(90deg, var(--rating-fill) calc(var(--rating) / 5 * 100%), var(--rating-empty) calc(var(--rating) / 5 * 100%));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  .rating-reviews-text {
    font-size: 0.9rem;
    color: #555;
  }

  .product-form {
    display: block;
  }
  .product-form__option {
    margin-bottom: 1rem;
  }
  .product-form__option label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600; /* Make labels a bit bolder */
  }
  .product-form__option select {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #ccc;
    border-radius: 4px; /* Slightly rounded corners */
    background-color: white;
    appearance: none; /* Remove default select arrow */
    background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%204%205%22%3E%3Cpath%20fill%3D%22%23333%22%20d%3D%22M2%200L0%202h4zm0%205L0%203h4z%22%2F%3E%3C%2Fsvg%3E'); /* Custom arrow */
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    background-size: 8px 10px;
    cursor: pointer;
  }
  .product-form__quantity {
    display: flex;
    align-items: center;
    gap: 1rem; /* Space between label and selector */
    margin-bottom: 1rem;
  }
  .product-form__quantity label {
    margin-bottom: 0; /* Remove bottom margin as it's inline */
  }
  .product-form__buttons {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-top: 1.5rem;
  }
  .button {
    padding: 0.75rem 1.5rem;
    border: 1px solid black;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease-in-out; /* Smooth transition */
    text-decoration: none; /* Ensure no underline */
    display: inline-block; /* For proper padding and alignment */
    width: 100%; /* Full width buttons */
    box-sizing: border-box; /* Include padding and border in width */
    font-size: 1rem; /* Consistent font size */
    border-radius: 4px; /* Rounded corners for buttons */
  }
  .button--primary {
    background-color: black;
    color: white;
  }
  .button--primary:hover {
    background-color: #333;
    border-color: #333;
  }
  .button--secondary { /* Added for the bundle button */
    background-color: #f0f0f0;
    color: #333;
    border-color: #ccc;
  }
  .button--secondary:hover {
    background-color: #e0e0e0;
  }
  .button[disabled] {
    opacity: 0.5;
    cursor: not-allowed;
    background-color: #ccc;
    border-color: #ccc;
    color: #666;
  }
  .shopify-payment-button__button {
    border: 1px solid #555;
    background-color: #f8f8f8; /* Lighter background for secondary button */
    color: #333;
  }
  .shopify-payment-button__button:hover {
    background-color: #eee;
  }

  .product-description {
    margin-top: 1.5rem;
    line-height: 1.6; /* Improved readability */
    color: #333;
  }

  .product-info__promo-text {
    text-align: center;
    font-size: 0.9rem; /* Slightly larger for prominence */
    margin-top: 1rem;
    color: #555;
    background-color: #f9f9f9; /* Light background for promo text */
    padding: 0.75rem;
    border-radius: 4px;
    border: 1px dashed #eee; /* Dotted border for a "promo" feel */
  }

  /* Pestaña Colapsable */
  .collapsible-tab {
    border-bottom: 1px solid #eee;
    padding: 1rem 0;
  }
  .collapsible-tab__title {
    cursor: pointer;
    font-weight: 600;
    list-style: none;
    display: flex;
    justify-content: space-between;
    align-items: center; /* Align arrow vertically */
    padding: 0.5rem 0; /* Add some vertical padding */
  }
  .collapsible-tab__title::-webkit-details-marker {
    display: none;
  }
  .collapsible-tab__title::after {
    content: '+';
    font-size: 1.5rem; /* Larger plus sign */
    line-height: 1; /* Align with text */
    transition: transform 0.2s ease-in-out;
  }
  .collapsible-tab[open] > .collapsible-tab__title::after {
    transform: rotate(45deg);
  }
  .collapsible-tab__content {
    padding-top: 1rem;
    color: #333;
    line-height: 1.6;
  }

  /* Quantity Selector (component-quantity-selector.css) - Included here for completeness */
  .quantity-selector {
    display: flex;
    align-items: center;
    border: 1px solid #ccc;
    border-radius: 4px;
    overflow: hidden; /* Ensures borders are contained */
  }
  .quantity-selector__button {
    background-color: #f0f0f0;
    border: none;
    padding: 0.5rem 0.8rem;
    cursor: pointer;
    font-size: 1.2rem;
    transition: background-color 0.2s ease-in-out;
    flex-shrink: 0; /* Prevent buttons from shrinking */
  }
  .quantity-selector__button:hover {
    background-color: #e0e0e0;
  }
  .quantity-selector__input {
    width: 4rem; /* Fixed width for input */
    text-align: center;
    border: none;
    padding: 0.5rem 0;
    -moz-appearance: textfield; /* Hide arrows on Firefox */
    font-size: 1rem;
    color: #333;
  }
  .quantity-selector__input::-webkit-outer-spin-button,
  .quantity-selector__input::-webkit-inner-spin-button {
    -webkit-appearance: none; /* Hide arrows on Chrome/Safari */
    margin: 0;
  }

  /* Styles for the new Bundle Module */
  .bundle-module {
    margin-top: 2rem;
    padding: 1.5rem;
    border: 2px dashed #999; /* Dotted border for "bundle" feel */
    border-radius: 8px;
    background-color: #fdfdfd;
    text-align: center;
  }

  .bundle-module h2 {
    font-size: 1.8rem;
    margin-bottom: 1rem;
    color: #007bff; /* Highlight color for discount */
  }

  .bundle-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
    margin-top: 1.5rem;
  }

  @media (min-width: 600px) {
    .bundle-card {
      flex-direction: row;
      justify-content: center;
      text-align: left;
    }
  }

  .bundle-card__image img {
    max-width: 150px;
    height: auto;
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }

  .bundle-card__info {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    align-items: center; /* Center items on mobile */
  }

  @media (min-width: 600px) {
    .bundle-card__info {
      align-items: flex-start; /* Align to start on larger screens */
    }
  }

  .bundle-card__info h3 {
    font-size: 1.2rem;
    margin: 0;
  }

  .bundle-card__price {
    font-size: 1.1rem;
    font-weight: bold;
    color: #555;
    margin: 0;
  }

  .bundle-card__variant-picker {
    width: 100%;
    max-width: 250px; /* Constrain width for selectors */
  }

  .bundle-card__variant-picker label {
    font-size: 0.9rem;
    margin-bottom: 0.25rem;
    text-align: left;
  }

  .bundle-card__variant-picker select {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #ccc;
    border-radius: 4px;
  }

  .add-bundle-to-cart {
    margin-top: 1rem;
  }

</style>

{# --- JAVASCRIPT PERSONALIZADO PARA EL BUNDLE --- #}
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const addBundleToCartButton = document.querySelector('.add-bundle-to-cart');

    if (addBundleToCartButton) {
      addBundleToCartButton.addEventListener('click', async () => {
        const mainProductId = addBundleToCartButton.dataset.mainProductId;
        const bundleProductId = addBundleToCartButton.dataset.bundleProductId;
        const bundleProductHandle = addBundleToCartButton.dataset.bundleProductHandle;

        if (!mainProductId || !bundleProductId) {
          alert('Error: IDs de producto principal o bundle no encontrados.');
          return;
        }

        addBundleToCartButton.disabled = true;
        addBundleToCartButton.textContent = 'Añadiendo...';

        try {
          const response = await fetch('/cart/add.js', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Accept': 'application/json'
            },
            body: JSON.stringify({
              items: [
                {
                  id: mainProductId,
                  quantity: 1,
                  properties: {
                    '_bundle_id': bundleProductHandle
                  }
                },
                {
                  id: bundleProductId,
                  quantity: 1,
                  properties: {
                    '_bundle_id': bundleProductHandle
                  }
                }
              ]
            })
          });

          const data = await response.json();

          if (response.ok) {
            alert('¡Bundle añadido al carrito con éxito!');
            window.location.href = '/cart'; 
          } else {
            console.error('Error al añadir el bundle:', data);
            alert(`Error al añadir el bundle: ${data.message || 'Desconocido'}`);
          }
        } catch (error) {
          console.error('Error de red al añadir el bundle:', error);
          alert('Ocurrió un error de conexión al añadir el bundle.');
        } finally {
          addBundleToCartButton.disabled = false;
          addBundleToCartButton.textContent = 'Añadir Bundle al Carrito (10% OFF)';
        }
      });
    }

    const bundleVariantSelector = document.querySelector('.bundle-variant-selector');
    if (bundleVariantSelector) {
        bundleVariantSelector.addEventListener('change', (event) => {
            const selectedVariantId = event.target.value;
            const bundleProductHandle = addBundleToCartButton.dataset.bundleProductHandle;

            fetch(`/products/${bundleProductHandle}.js`)
                .then(response => response.json())
                .then(productData => {
                    const selectedVariant = productData.variants.find(variant => variant.id == selectedVariantId);
                    if (selectedVariant && selectedVariant.featured_image) {
                        const bundleImage = document.querySelector('.bundle-card__image img');
                        if (bundleImage) {
                            bundleImage.src = selectedVariant.featured_image.src.replace(/(\.[\w\d]+)$/, '_300x$1');
                        }
                    }

                    if (addBundleToCartButton) {
                        addBundleToCartButton.dataset.bundleProductId = selectedVariantId;
                        addBundleToCartButton.disabled = !selectedVariant.available;
                        if (!selectedVariant.available) {
                            addBundleToCartButton.textContent = 'Producto del Bundle Agotado';
                        } else {
                            addBundleToCartButton.textContent = 'Añadir Bundle al Carrito (10% OFF)';
                        }
                    }
                })
                .catch(error => console.error('Error fetching bundle product data:', error));
        });
    }
  });
</script>


{% schema %}
{
  "name": "Producto (Custom)",
  "tag": "section",
  "class": "product-section-wrapper",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_breadcrumbs",
      "label": "Mostrar migas de pan (breadcrumbs)",
      "default": true
    },
    {
      "type": "text",
      "id": "shipping_promo_text",
      "label": "Texto de promoción de envío",
      "default": "Envío gratis en pedidos superiores a 50€",
      "info": "Este texto aparecerá debajo de los botones de compra."
    },
    {
      "type": "url", # Changed from product_reference
      "id": "bundle_product_url", # Changed ID
      "label": "Producto del bundle",
      "info": "Selecciona el producto que se ofrecerá en este bundle junto al producto principal.",
      "options": "product" # Added options to specifically select a product via URL
    }
  ],
  "blocks": [
    {
      "type": "@app"
    },
    {
      "type": "title",
      "name": "Título del producto",
      "limit": 1
    },
    {
      "type": "price",
      "name": "Precio",
      "limit": 1
    },
    {
      "type": "rating",
      "name": "Valoración (Estrellas)",
      "limit": 1,
      "settings": [
        {
          "type": "range",
          "id": "rating_value",
          "min": 0,
          "max": 5,
          "step": 0.1,
          "label": "Valoración de estrellas (placeholder)",
          "default": 4.5,
          "info": "Este es un valor de ejemplo. Para valoraciones reales, usa el 'Código de la app de reseñas'."
        },
        {
          "type": "text",
          "id": "review_count",
          "label": "Número de reseñas (placeholder)",
          "default": "12",
          "info": "Este es un valor de ejemplo."
        },
        {
          "type": "header",
          "content": "Para una integración real"
        },
        {
          "type": "liquid",
          "id": "rating_code",
          "label": "Código de la app de reseñas",
          "info": "Pega aquí el código de tu aplicación de reseñas (ej. Judge.me, Loox, etc.) para mostrar las estrellas reales."
        }
      ]
    },
    {
      "type": "variant_picker",
      "name": "Selector de variantes",
      "limit": 1
    },
    {
      "type": "quantity_selector",
      "name": "Selector de cantidad",
      "limit": 1
    },
    {
      "type": "buy_buttons",
      "name": "Botones de compra",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_dynamic_checkout",
          "label": "Mostrar botón de compra dinámica",
          "info": "Permite a los clientes usar un método de pago rápido como Apple Pay o PayPal.",
          "default": true
        }
      ]
    },
    {
      "type": "description",
      "name": "Descripción del producto",
      "limit": 1
    },
    {
      "type": "collapsible_tab",
      "name": "Pestaña colapsable",
      "limit": 5,
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Título de la pestaña",
          "default": "Información adicional"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Contenido de la pestaña",
          "info": "Añade texto, imágenes o videos en esta pestaña."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Producto Principal (Default)",
      "blocks": [
        { "type": "title" },
        { "type": "price" },
        { "type": "rating" },
        { "type": "variant_picker" },
        { "type": "quantity_selector" },
        { "type": "buy_buttons" },
        { "type": "description" },
        { "type": "collapsible_tab",
          "settings": {
            "heading": "Detalles"
          }
        },
        { "type": "collapsible_tab",
          "settings": {
            "heading": "Envíos y Devoluciones"
          }
        }
      ]
    }
  ]
}
{% endschema %}